"use strict";(self["webpackChunkmanage"]=self["webpackChunkmanage"]||[]).push([[560],{833:function(e,t,r){r.d(t,{Z:function(){return s}});var a=function(){var e=this,t=e._self._c;return t("div",[t("el-breadcrumb",{attrs:{separator:"/"}},e._l(e.breadList,(function(r,a){return t("el-breadcrumb-item",{key:a},[e._v(e._s(r))])})),1)],1)},o=[],l={data(){return{breadList:[]}},created(){this.getBreadCrumb()},watch:{$route(){this.getBreadCrumb()}},methods:{getBreadCrumb(){this.breadList=this.$route.meta.bread||[]}}},i=l,n=r(1001),c=(0,n.Z)(i,a,o,!1,null,"5fe194f7",null),s=c.exports},6560:function(e,t,r){r.r(t),r.d(t,{default:function(){return Z}});var a=function(){var e=this,t=e._self._c;return t("div",[t("BreadCrumb"),t("el-card",[t("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){return e.addShow(!0)}}},[e._v("添加项目")]),t("el-dialog",{attrs:{title:"添加项目",visible:e.show},on:{"update:visible":function(t){e.show=t}}},[t("AddProject",{ref:"addProject",attrs:{typeList:e.typeList,projectData:e.projectData,tableKey:e.tableKey},on:{addShow:e.addShow,changeProjectData:e.changeProjectData}})],1),t("PerformanceProject",{attrs:{projectData:e.projectData,tableKey:e.tableKey},on:{addShow:e.addShow,editProject:e.editProject,deleteProject:e.deleteProject}}),t("PerformancePointer",{ref:"pointer",attrs:{pointerData:e.pointerData,projectData:e.projectData}}),t("el-button",{attrs:{type:"primary"}},[e._v("获得结果"),t("i",{staticClass:"el-icon-cpu el-icon--right"})]),t("el-button",{attrs:{type:"primary"}},[e._v("上传"),t("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1)},o=[],l=r(833),i=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.projectData}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[t("el-form-item",{attrs:{label:"项目类型"}},[t("span",[e._v(e._s(r.row.type))])]),t("el-form-item",{attrs:{label:"完成月份"}},[t("span",[e._v(e._s(r.row.completion_month))])]),t("el-form-item",{attrs:{label:"项目名称"}},[t("span",[e._v(e._s(r.row.project_name))])]),t("el-form-item",{attrs:{label:"立项编号"}},[t("span",[e._v(e._s(r.row.project_number))])]),t("el-form-item",{attrs:{label:"担当角色"}},[t("span",[e._v(e._s(r.row.role))])]),t("el-form-item",{attrs:{label:"类型"}},[t("span",[e._v(e._s(r.row.project_type))])]),t("el-form-item",{attrs:{label:"项目金额"}},[t("span",[e._v(e._s(r.row.project_amount))])]),t("el-form-item",{attrs:{label:"外包金额"}},[t("span",[e._v(e._s(r.row.outsourcing_amount))])]),e._e(),e._e(),t("el-form-item",{attrs:{label:"浮动占比"}},[t("span",[e._v(e._s(r.row.floating_ratio))])]),t("el-form-item",{attrs:{label:"总完成金额"}},[t("span",[e._v(e._s(r.row.total_completion_amount))])]),t("el-form-item",{attrs:{label:"协助投标数量"}},[t("span",[e._v(e._s(r.row.bid_assistance_quantity))])]),t("el-form-item",{attrs:{label:"利润率"}},[t("span",[e._v(e._s(r.row.profit_margin))])]),t("el-form-item",{attrs:{label:"备注"}},[t("span",[e._v(e._s(r.row.remarks))])])],2)]}}])}),t("el-table-column",{attrs:{label:"项目类型",prop:"type"}}),t("el-table-column",{attrs:{label:"项目名称",prop:"project_name"}}),t("el-table-column",{attrs:{label:"总完成金额",prop:"total_completion_amount"}}),t("el-table-column",{attrs:{label:"利润率",prop:"profit_margin"}}),t("el-table-column",{attrs:{label:"协助投标数量",prop:"bid_assistance_quantity"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.projectEdit(r.$index,r.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.projectDelete(r.$index,r.row)}}},[e._v("删除")])]}}])})],1)],1)},n=[],c={name:"performanceProject",props:["projectData","tableKey"],deta(){return{}},methods:{projectEdit(e,t){this.$emit("addShow",!0),this.$emit("editProject",{...t,index:e})},projectDelete(e){this.$emit("deleteProject",e)}}},s=c,u=r(1001),p=(0,u.Z)(s,i,n,!1,null,null,null),m=p.exports,d=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"ruleProject",staticClass:"demo-ruleForm",attrs:{model:e.ruleProject,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"项目类型",prop:"type"}},[t("el-select",{model:{value:e.ruleProject.type,callback:function(t){e.$set(e.ruleProject,"type",t)},expression:"ruleProject.type"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"完成月份",prop:"completion_month"}},[t("el-input",{model:{value:e.ruleProject.completion_month,callback:function(t){e.$set(e.ruleProject,"completion_month",t)},expression:"ruleProject.completion_month"}})],1),t("el-form-item",{attrs:{label:"项目名称",prop:"project_name"}},[t("el-input",{model:{value:e.ruleProject.project_name,callback:function(t){e.$set(e.ruleProject,"project_name",t)},expression:"ruleProject.project_name"}})],1),t("el-form-item",{attrs:{label:"立项编号",prop:"project_number"}},[t("el-input",{model:{value:e.ruleProject.project_number,callback:function(t){e.$set(e.ruleProject,"project_number",t)},expression:"ruleProject.project_number"}})],1),t("el-form-item",{attrs:{label:"担当角色",prop:"role"}},[t("el-input",{model:{value:e.ruleProject.role,callback:function(t){e.$set(e.ruleProject,"role",t)},expression:"ruleProject.role"}})],1),t("el-form-item",{attrs:{label:"类型",prop:"project_type"}},[t("el-input",{model:{value:e.ruleProject.project_type,callback:function(t){e.$set(e.ruleProject,"project_type",t)},expression:"ruleProject.project_type"}})],1),t("el-form-item",{attrs:{label:"项目金额",prop:"project_amount"}},[t("el-input",{model:{value:e.ruleProject.project_amount,callback:function(t){e.$set(e.ruleProject,"project_amount",t)},expression:"ruleProject.project_amount"}})],1),t("el-form-item",{attrs:{label:"外包金额",prop:"outsourcing_amount"}},[t("el-input",{model:{value:e.ruleProject.outsourcing_amount,callback:function(t){e.$set(e.ruleProject,"outsourcing_amount",t)},expression:"ruleProject.outsourcing_amount"}})],1),e._e(),e._e(),t("el-form-item",{attrs:{label:"浮动占比",prop:"floating_ratio"}},[t("el-input",{model:{value:e.ruleProject.floating_ratio,callback:function(t){e.$set(e.ruleProject,"floating_ratio",t)},expression:"ruleProject.floating_ratio"}})],1),t("el-form-item",{attrs:{label:"协助投标数量",prop:"bid_assistance_quantity"}},[t("el-input",{model:{value:e.ruleProject.bid_assistance_quantity,callback:function(t){e.$set(e.ruleProject,"bid_assistance_quantity",t)},expression:"ruleProject.bid_assistance_quantity"}})],1),t("el-form-item",{attrs:{label:"利润率",prop:"profit_margin"}},[t("el-input",{model:{value:e.ruleProject.profit_margin,callback:function(t){e.$set(e.ruleProject,"profit_margin",t)},expression:"ruleProject.profit_margin"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remarks"}},[t("el-input",{model:{value:e.ruleProject.remarks,callback:function(t){e.$set(e.ruleProject,"remarks",t)},expression:"ruleProject.remarks"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.changeProject(!1,"submit",e.ruleProject)}}},[e._v("确定")]),t("el-button",{on:{click:function(t){return e.changeProject(!0)}}},[e._v("重置")]),t("el-button",{on:{click:function(t){return e.changeProject(!1)}}},[e._v("取 消")])],1)],2)],1)},b=[],_={neme:"addProject",props:["typeList","projectData","tableKey"],data(){return{ruleProject:{type:"",completion_month:"",project_name:"",project_number:"",role:"",project_type:"",project_amount:"",outsourcing_amount:"",floating_ratio:"",total_completion_amount:"",bid_assistance_quantity:"",profit_margin:"",remarks:""}}},methods:{fillData(e){this.ruleProject=e},changeProject(e,t,r){if("submit"==t){let e=this.projectData,{project_amount:t,outsourcing_amount:a,floating_ratio:o}=r;if(a||=100,o||=100,r.total_completion_amount=t*a/100*o/100,0===e.length)e.push(r);else{const t=r.index+1?r.index:e.length;e[t]=r}this.$emit("changeProjectData",e)}this.ruleProject={type:"",completion_month:"",project_name:"",project_number:"",role:"",project_type:"",project_amount:"",outsourcing_amount:"",floating_ratio:"",total_completion_amount:"",bid_assistance_quantity:"",profit_margin:"",remarks:""},this.$emit("addShow",e)}}},f=_,j=(0,u.Z)(f,d,b,!1,null,null,null),h=j.exports,v=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("el-table",{key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.pointerData,border:""}},[t("el-table-column",{attrs:{prop:"name",label:"考核项"}}),t("el-table-column",{attrs:{prop:"indicator",label:"考核指标"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{on:{change:function(t){return e.changePointer(r.row,r.$index)}},model:{value:r.row.indicator,callback:function(t){e.$set(r.row,"indicator",t)},expression:"scope.row.indicator"}})]}}])}),t("el-table-column",{attrs:{prop:"completion_value",label:"实际完成值"}}),t("el-table-column",{attrs:{prop:"schedule",label:"完成情况"}}),t("el-table-column",{attrs:{prop:"ratio",label:"各项占比(%)"}}),t("el-table-column",{attrs:{prop:"coefficient",label:"系数"}}),t("el-table-column",{attrs:{prop:"remarks",label:"备注"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-input",{attrs:{type:"textarea"},model:{value:r.row.remarks,callback:function(t){e.$set(r.row,"remarks",t)},expression:"scope.row.remarks"}})]}}])})],1)],1),t("el-card",[t("el-descriptions",{attrs:{title:"统计结果",direction:"vertical",column:5,border:""}},[t("el-descriptions-item",{attrs:{label:"各项系数合计"}},[e._v(e._s(e.ratioTotal))]),t("el-descriptions-item",{attrs:{label:"总加分"}}),t("el-descriptions-item",{attrs:{label:"总减分"}}),t("el-descriptions-item",{attrs:{label:"考核得分"}},[e._v(e._s(e.score))]),t("el-descriptions-item",{attrs:{label:"考核结果"}},[e._v(e._s(e.result))])],1)],1)],1)},y=[];function P(e,t){let r;const a=t.filter((e=>"完成项目金额"===e.type));"完成项目金额"==e?r=k(a):"季度利润率"==e?r=g(a):"协助投标数量"==e&&(r=w(a));const o=t.filter((e=>"团队营业额"===e.type));"团队营业额"===e?r=k(o):"广丰利润率"===e?r="20%":"整组季度利润率"===e?r=g(o):"投标项目数量"===e&&(r=w(o));const l=t.filter((e=>"未中标项目"!==e.type)),i=t.filter((e=>"中标项目"===e.type)),n=t.filter((e=>"团队中标项目"===e.type));"投标数量"===e?r=w(t):"团队利润率"===e?r=g(l):"中标数量"===e?r=w(i):"中标金额"===e?r=k(i):"团队中标金额"===e&&(r=k(n)),"投标数量"===e?r=w(t):"主笔利润率"===e||("中标数量"===e?r=w(i):"中标金额"===e&&(r=k(i)));const c=t.filter((e=>"完成项目金额"===e.type)),s=t.filter((e=>"版块担当数量"===e.type)),u=t.filter((e=>"未中标项目"!==e.type)),p=t.filter((e=>"版块担当数量"!==e.type));"完成项目金额"===e?r=k(c):"版块担当数量"===e?r=w(s):"季度利润率"===e?r=g(u):"投标项目数量"===e&&(r=w(p));const m=t.filter((e=>"完成项目金额"===e.type)),d=t.filter((e=>"团队完成项目"===e.type)),b=t.filter((e=>"未中标项目"!==e.type));"完成项目金额"===e?r=k(m):"团队完成金额"===e?r=k(d):"团队版块担当数量"===e||("团队利润率"===e?r=g(b):"投标项目数量"===e&&(r=w(t)));const _=t.filter((e=>"团队投标项目"===e.type)),f=t.filter((e=>"团队完成项目"===e.type)),j=t.filter((e=>"未中标项目"!==e.type||"团队投标项目"!==e.type));return"投标数量"===e?r=w(_):"执行项目数量"===e?r=w(j):"季度利润率"===e?r=g(f):"团队完成额"===e&&(r=k(j)),r}function k(e){return e.reduce(((e,t)=>e+Number(t.total_completion_amount)),0).toString().replace(/^0+([1-9])/)}function g(e){let t=e.reduce(((e,t)=>e+t.profit_margin*t.project_amount),0);return 0!==t?t/D(e,"project_amount"):0}function w(e){return e.reduce(((e,t)=>e+Number(t.bid_assistance_quantity)),0).toString().replace(/^0+([1-9])/)}function D(e,t){return e.reduce(((e,r)=>e+Number(r[t])),0).toString().replace(/^0+([1-9])/,"$1")}var x={name:"performancePointer",props:["pointerData","projectData"],data(){return{tableKey:""}},methods:{changePointer(e,t){Number(e.indicator)?this.completion(e.name,t):(e.coefficient="",e.schedule="")},completion(e,t){const r=this.pointerData[t];r.completion_value=P(e,this.projectData),r.schedule=(r.completion_value/r.indicator).toFixed(4),r.coefficient=(r.schedule*parseFloat(r.ratio)/100).toFixed(2),this.tableKey+=1}},computed:{ratioTotal(){let e=0;for(let t=0;t<this.pointerData.length;t++)this.pointerData[t].indicator&&(e+=Number(this.pointerData[t].coefficient));return e.toFixed(2)||""},score(){return Number(this.ratioTotal).toFixed(2)||""},result(){const e=this.score,t=()=>e<.8?"不称职":e>=.8&&e<=.99?"需改进":e>=1&&e<=1.19?"称职":e>=1.2&&e<=1.29?"良好":e>=1.3?"优秀":void 0;return""!==e?t():""}}},$=x,S=(0,u.Z)($,v,y,!1,null,null,null),K=S.exports,C={name:"performanceDetail",components:{BreadCrumb:l.Z,PerformanceProject:m,AddProject:h,PerformancePointer:K},data(){return{typeList:"",show:!1,projectData:[],pointerData:[],tableKey:""}},mounted(){this.projectType()},methods:{projectType(e){const t=[];let r=[];const a={indicator:"",completion_value:"",schedule:"",coefficient:"",remarks:""},o={id1:[{name:"完成项目金额",ratio:40},{name:"季度利润率",ratio:45},{name:"协助投标数量",ratio:15}],id2:[{name:"团队营业额",ratio:40},{name:"广丰利润率",ratio:22.5},{name:"整组季度利润率",ratio:22.5},{name:"投标项目数量",ratio:15}],id3:[{name:"投标数量",ratio:25},{name:"团队利润率",ratio:20},{name:"中标数量",ratio:25},{name:"中标金额",ratio:15},{name:"团队中标金额",ratio:15}],id4:[{name:"投标数量",ratio:25},{name:"主笔利润率",ratio:20},{name:"中标数量",ratio:25},{name:"中标金额",ratio:30}],id5:[{name:"完成项目金额",ratio:25},{name:"版块担当数量",ratio:20},{name:"季度利润率",ratio:45},{name:"投标项目数量",ratio:10}],id6:[{name:"完成项目金额",ratio:12.5},{name:"团队完成金额",ratio:12.5},{name:"团队版块担当数量",ratio:20},{name:"团队利润率",ratio:45},{name:"投标项目数量",ratio:10}],id7:[{name:"投标数量",ratio:15},{name:"执行项目数量",ratio:20},{name:"季度利润率",ratio:45},{name:"团队完成额",ratio:20}],id8:[{name:"投标数量",ratio:15},{name:"执行数量",ratio:20},{name:"季度利润率",ratio:45},{name:"完成额度",ratio:20}],id9:[{name:"执行项目数量",ratio:30},{name:"季度利润率",ratio:20},{name:"项目完成金额",ratio:50}],id10:[{name:"投标数量",ratio:25},{name:"季度利润率",ratio:20},{name:"中标数量",ratio:25},{name:"中标金额",ratio:30}],id11:[{name:"投标数量",ratio:25},{name:"季度利润率",ratio:20},{name:"中标数量",ratio:20},{name:"中标数量",ratio:15},{name:"团队中标金额",ratio:15}]};switch(e="客户部主任",e){case"客户部主任":t.push({value:"完成项目金额",label:"完成项目金额"},{value:"协助项目",label:"协助项目"}),r=o.id1;break;case"客户部副总监":t.push({value:"团队营业额",label:"团队营业额"}),r=o.id2;break;case"策划部副总监":t.push({value:"中标项目",label:"中标项目"},{value:"团队中标项目",label:"团队中标项目"}),r=o.id3;break;case"策划部主任":t.push({value:"中标项目",label:"中标项目"},{value:"备注（附加）",label:"备注（附加）"}),r=o.id4;break;case"项目部经理":t.push({value:"完成项目金额",label:"完成项目金额"},{value:"版块担当数量",label:"版块担当数量"}),r=o.id5;break;case"项目部总监":t.push({value:"完成项目金额",label:"完成项目金额"},{value:"团队完成项目",label:"团队完成项目"}),r=o.id6;break;case"演出总监":t.push({value:"完成额度",label:"完成额度"},{value:"团队投标项目",label:"团队投标项目"},{value:"团队完成额",label:"团队完成额"}),r=o.id7;break;case"演出副总监":t.push({value:"中标项目",label:"中标项目"}),r=o.id8;break;case"设计部平面":t.push({value:"执行项目数量",label:"执行项目数量"},{value:"协助投标",label:"协助投标"}),r=o.id9;break;case"设计部3d":t.push({value:"中标项目",label:"中标项目"},{value:"中标金额",label:"中标金额"}),r=o.id10;break;case"设计部总监":t.push({value:"中标项目",label:"中标项目"},{value:"个人完成项目",label:"个人完成项目"}),r=o.id11;break}t.push({value:"未中标项目",label:"未中标项目"}),this.typeList=t;for(let l=0;l<r.length;l++)r[l]={...r[l],...a};this.pointerData=r},addShow(e){this.show=e},changeProjectData(e){this.projectData=e,this.tableKey+=1;for(let t=0;t<this.pointerData.length;t++)this.pointerData[t].indicator&&this.$refs.pointer.completion(this.pointerData[t].name,t)},editProject(e){this.$refs.addProject.fillData(e)},deleteProject(e){this.projectData.splice(e,1);for(let t=0;t<this.pointerData.length;t++)this.pointerData[t].indicator&&this.$refs.pointer.completion(this.pointerData[t].name,t)}}},q=C,L=(0,u.Z)(q,a,o,!1,null,"01791682",null),Z=L.exports}}]);
//# sourceMappingURL=560.9a57af7f.js.map